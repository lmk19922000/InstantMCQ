<meta name="viewport" content="width=device-width">
<h2>screen</h2>
<script src='/socket.io/socket.io.js'></script>
<script src='/una_js/una.js'></script>
<script src='/js/screen.js'></script>
<script src='https://www.google.com/jsapi'></script>
<body><div id="chart_div"></div></body>
script(type='text/javascript').
	google.load('visualization', '1.0', {'packages':['corechart']});
	//google.setOnLoadCallback(drawChart);
		function drawChart() {
			var data = new google.visualization.DataTable();
			data.addColumn('string', 'Choices');
			data.addColumn('number', 'Slices');
			data.addRows(tempData);
			vpw = window.innerWidth*0.9;
			vph = window.innerHeigh*0.9;
			var options = {'title':'Multiple Choices Questions','width':vpw,'height':vph, pieSliceText: 'value'};

			var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
			chart.draw(data, options);
		}
		var chart = document.getElementById('chart_div');
		vpw = window.innerWidth;
		vph = window.innerHeight;
		chart.style.width=vpw+'px';
		chart.style.height=vph+'px';
		var room_id = 'room1';
		var screen_data = {name: 'screen'};
		UnaScreen.register(room_id, screen_data, function(res) {
			if (res.success) {
				// Screen registered successfully
			} else {
				// Screen registration failed
			}
		});
		var userTable = new Object();
		UnaScreen.onControllerInput("buttonClicked", function(res) {	
			if(!userTable[res.una.id]){
				console.log("recieve  "+res.payload.buttonID);
				
			}else{

			}
			updateDate(res.payload.buttonID);
			drawChart();
		});
		var tempData = [];
		var indexTable = new Object();
		indexTable['A']=0;indexTable['B']=0;indexTable['C']=0;indexTable['D']=0;
		function updateDate(buttonID){
			indexTable[buttonID]++;
			tempData=[['A',indexTable['A']],['B',indexTable['B']],['C',indexTable['C']],['D',indexTable['D']]];
		}